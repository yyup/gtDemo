<!doctype html>
<html lang="en">
 <head>
  <meta charset="UTF-8">
  <meta name="Generator" content="DeepSeaWeb! Team">
  <meta name="Author" content="DeepSeaWeb! Team">
  <meta name="Keywords" content="沃特罗伦WaterRower（直译水划船机）始创于1988年。由美国国家划船队John Duke与耶鲁大学联合设计，并获发明专利。不仅是品牌，更是划船器水阻化的标志性里程碑。">
  <meta name="Description" content="沃特罗伦WaterRower（直译水划船机）始创于1988年。由美国国家划船队John Duke与耶鲁大学联合设计，并获发明专利。不仅是品牌，更是划船器水阻化的标志性里程碑。">
  <title>网络商店-WaterRower沃特罗伦中国官方网站</title>
  <link rel="stylesheet" type="text/css"   href="../../style/prj/site/head.css" />
      <link rel="stylesheet" type="text/css"   href="../../style/prj/site/wlEsConfirmOrder.css" />
    <link rel="stylesheet" type="text/css"   href="../../style/prj/site/zzsc.css" />
     <link rel="stylesheet" type="text/css"   href="../../style/prj/site/footer.css" />
     <link rel="stylesheet" type="text/css"   href="../../style/prj/site/cnzz.css" />
    <script src="../../js/jquery.min.js"></script>
     <script src="../../js/joy.loader.js" modules="form,dataview,advgrid,layout"></script>
    <script src="../../js/site/jquery.cookie.js"></script><!--qq-->
    <script src="../../js/site/jquery.tipsy.js"></script><!--qq-->
    <script src="../../js/site/start_v5.js"></script><!--qq-->
      <script src="../../js/site/shieldingRightClick.js"></script><!--屏蔽右键-->
	  <script src="../../js/site/jquery.placeholder.min.js"></script><!--placeholder-->
    <script type="text/javascript" src="../../js/site/getParam.js"></script>
        <script type="text/javascript" src="../../js/site/common.js"></script>
    
 </head>
 <body>
     <div id="floater" ><img border=0 src="../../style/prj/images/solid.png" ></div>

 <!-- qq 开始 -->

<div id="online_qq_layer" show="1" >
	    <div id="online_qq_tab">
	        <div class="online_icon">
	            <a title="联系我们" id="floatTrigger" href="javascript:void(0);"></a>
	        </div>
	    </div>
  <div id="onlineService">
    <div class="online_windows overz">
		      <div class="online_w_top"> </div>
		  <!--online_w_top end-->
				  <div class="online_w_c overz">
						<div class="online_bar collapse" id="onlineSort1">
								<h2> <a href="javascript:;">在线技术支持</a> </h2>
							  <div class="online_content overz" id="onlineType1" style="display: block;">
									<ul class="overz">
									   <li><a href="http://wpa.qq.com/msgrd?v=3&uin=496809153&site=qq&menu=yes" target="_blank"><img border="0" src="../../style/prj/images/qq.jpg" alt="我们竭诚为您服务！" title="我们竭诚为您服务！"/></a></li>
									   <li><a target="_blank" href="http://wpa.qq.com/msgrd?v=3&uin=496809153&site=qq&menu=yes"><img border="0" src="../../style/prj/images/qq.jpg" alt="我们竭诚为您服务！" title="我们竭诚为您服务！"/></a></li>
									   <li><a target="_blank" href="http://wpa.qq.com/msgrd?v=3&uin=496809153&site=qq&menu=yes"><img border="0" src="../../style/prj/images/qq.jpg" alt="我们竭诚为您服务！" title="我们竭诚为您服务！"/></a></li>
									 <li style="height:1px;"></li>
									  
									</ul>
							  </div>
						  <!--online_content end-->
						</div>
				  </div>
		  <!--online_w_c end-->
					 <div class="online_w_bottom"> </div>
		  <!--online_w_bottom end-->
		</div>
    <!--online_windows end-->
  </div>
</div>
 <!--qq结束-->

<!-- 头部-->
  <div class="head">
     <!--头部标题栏开始-->
	 <div class="titleContainer">
     <div class="title">
	     <div class="time">创始于美国1988</div>
	      <div class="land"><a href="login.html">会员登录</a>|<a href="register.html">注册</a></div>  
	   </div>
	  </div>
	     <!--头部标题栏结束-->
	   <!--菜单栏开始-->
	   <div class="menu">
	       <div class="listContent">		   
		     <ul class="listMenu">
		      <li >  
                  <a  href="首页.html"> <div id="headLogo" ></div></a>
			  </li>  
			  <li>
			    <a href="wlCmInfo.html">
					<div class="topTitle">沃特罗伦简介</div>
					<div class="bottomTitle">独特的锻炼</div>
				 </a>
			  </li>
			  <li>
			     <a href="wlCmInfo.html">
					 <div class="topTitle">家庭锻炼</div>
					<div class="bottomTitle">居家练习</div>
				</a>
			  </li>
			   <li>
			     <a href="wlCmInfo.html">
			       <div class="topTitle">专业训练</div>
				   <div class="bottomTitle">商业/专业机构</div>
				  </a>
			  </li>
			   <li class="menuActive">
			     <a href="wlCmSell.html">
			       <div class="topTitle">网上商店</div>
				   <div class="bottomTitle">设备及训练项目</div>
				  </a>
			  </li>
			  <li>
			    <a href="wlCmCustomerService.html">
			     <div class="topTitle">客户服务</div>
				 <div class="bottomTitle">服务与技术支持</div>
				</a>
			  </li>
			  <li>
			   <a href="wlCmUser.html">
			     <div class="topTitle">账号信息</div>
				 <div class="bottomTitle">我的账号</div>
				</a>
			  </li>
		   </ul>
		   </div>	
	   </div>
	    <!--菜单栏结束-->

    
</div>
<!--头部结束-->
  <div  id="generateOrdersBody">
       <div id="generateOrdersListContainer">
	           <div  id="generateOrdersTitle">
			    <div id="generateOrdersFirstTitle">确认收货地址</div>
			    <div id="management"><a href="wlEsMyDeliveryAddr.html">管理收货地址</a></div>
			    
			   </div>
			   <div id="noAddress"  style="display:none;"><a href="wlEsMyDeliveryAddr.html">您还没有收货地址，请先点击添加！</a></div>
	          <ul id="generateOrdersList">
	          <!--  
				   <li  class="active">
					<span class="marker-tip"  >寄送至</span>
				      <div class="address">
						 <input type="radio" id="1" name="address" checked="checked" onclick="chooseAddress($(this))" >
						  <label for="1">福建省 厦门市 思明区 莲前街道 塔埔东路166号804-805单元（观音山国际营运中心11号楼8层） (黄保敬 收)<em>18859230385</em> </label>
					  </div>
				   </li>
				   <li>
					<span class="marker-tip" style="display:none;" >寄送至</span>
				      <div class="address">
						 <input type="radio" id="2" name="address" onclick="chooseAddress($(this))" >
						  <label for="2">福建省 厦门市 思明区 莲前街道 塔埔东路166号804-805单元（观音山国际营运中心11号楼8层） (黄保敬 收)<em>18859230385</em> </label>
					  </div>
				   </li>	
				   <li>
					<span class="marker-tip" style="display:none;"  >寄送至</span>
				      <div class="address">
						 <input type="radio" id="3" name="address"  onclick="chooseAddress($(this))">
						  <label for="3">福建省 厦门市 思明区 莲前街道 塔埔东路166号804-805单元（观音山国际营运中心11号楼8层） (黄保敬 收)<em>18859230385</em> </label>
					  </div>
				   </li>	
				   -->
			  </ul>
	   </div>
	   <div id="goodsListContainer">
	     <h3>确认订单信息</h3>
		 <div id="goodsList">
		           <!--订单列表头部开始-->
				  <div class="carHead">
					   <ul id="carHeadList">
							
							<li>商品信息</li>
							<li>单价</li>
							<li>数量</li>
							<li>金额</li>
							<li>操作</li>
					   </ul>
				   </div>
				    <!--订单量列表开始-->
					<div class="carBody">
							  <ul class="carBodyList">
								 <!--<li>	
									<div class="item">
								   <div class="carImg" style="background:url('img/3.jpg');"></div>
										 <div  class="carImg">
												<img src="../../style/prj/tempImages/product.jpg" />
										 </div>
										 <div class="carProductName">
											<div class="carProductNameContent">
												沃特罗伦(waterRower)自然系列"俱乐部"款划船器沃特罗伦
											</div>		
										 </div>		 
									</div>
								 <div class="item">
									 <div class="verticalCenter">
										 12999.00
										</div>
								 </div>
								 <div class="item">
									<span class="carProductNumValue">
										 <div class="carReduce" onclick="reduceNum($(this))" >-</div>
										  <input type="text" class="carNumber"  value="1"  
												 />
										   <div class="carAdd" onclick="addNum($(this))">+</div>	  
									 </span>								 		 
								 </div>
								 <div  class="item"> <div class="verticalCenter">12999.00</div></div>
								 <div class="item operation">
									<div class="verticalCenter">
											删除
									 </div>
								 </div>
							   </li>
								<li>
									
									<div class="item">
								   <div class="carImg" style="background:url('img/3.jpg');"></div>
										 <div  class="carImg">
												<img src="../../style/prj/tempImages/product.jpg" />
										 </div>
										 <div class="carProductName">
											<div class="carProductNameContent">
												沃特罗伦(waterRower)自然系列"俱乐部"款划船器沃特罗伦
											</div>		
										 </div>		 
									</div>
								 <div class="item">
									 <div class="verticalCenter">
										 12999.00
										</div>
								 </div>
								 <div class="item">
									<span class="carProductNumValue">
										 <div class="carReduce" onclick="reduceNum($(this))" >-</div>
										  <input type="text" class="carNumber"  value="1"  
												/>
										   <div class="carAdd" onclick="addNum($(this))">+</div>	  
									 </span>								 		 
								 </div>
								 <div  class="item"> <div class="verticalCenter">12999.00</div></div>
								 <div class="item operation">
									<div class="verticalCenter">
											删除
									 </div>
								 </div>
							   </li>
								<li>
									
									<div class="item">
								  <div class="carImg" style="background:url('img/3.jpg');"></div>
										 <div  class="carImg">
												<img src="../../style/prj/tempImages/product.jpg" />
										 </div>
										 <div class="carProductName">
											<div class="carProductNameContent">
												沃特罗伦(waterRower)自然系列"俱乐部"款划船器沃特罗伦
											</div>		
										 </div>		 
									</div>
								 <div class="item">
									 <div class="verticalCenter">
										 12999.00
										</div>
								 </div>
								 <div class="item">
									<span class="carProductNumValue">
										 <div class="carReduce" onclick="reduceNum($(this))" >-</div>
										  <input type="text" class="carNumber"  value="1"  
												 />
										   <div class="carAdd" onclick="addNum($(this))">+</div>	  
									 </span>								 		 
								 </div>
								 <div  class="item"> <div class="verticalCenter">12999.00</div></div>
								 <div class="item operation">
									<div class="verticalCenter">
										删除
									 </div>
								 </div>
							   </li> -->
							 </ul>			 
		        </div>
                 <!--订单结束-->  
		  </div>
	   </div>

	    <div id="orderFooter">
			  <div id="orderFooterLeft">
						<label>给卖家留言：</label>
						<textarea  id="message" class="memo-input"  placeholder="选填：对本次交易的说明（建议填写已经和卖家达成一致的说明）" autocomplete="off" title="选填：对本次交易的说明（建议填写已经和卖家达成一致的说明）"></textarea> 
			  </div>
			  <div id="orderFooterRight">
					<div id="orderPrice">
						订单合计:<span>¥0.00</span>
					</div>
					  <div id="orderResultContainer">
					 应付总额:<span>¥0.00</span> 
					 </div>
					  <div  class="submitOrderContainer">
						<div id="nextStep"></div>
					 </div>
			  </div>
		</div>
  
  </div>







<div class="footer">

				 <!--联系我们开始-->
				<div id="contantUs">
				     <div id="left">
					  <div id="top">联系我们</div>
					  <div id="bottom">CONTACT US</div>
					 
					 </div>
					 
					 <div id="right">
                             <div id="top">
							       <div class="tel">
								     <img width="24" height="25" src="../../style/prj/images/tel.png">
									&nbsp;<span id="tel">电话:0592-5923510 / 5923128</span>
								   </div>
								   <div class="fax">
								     <img width="24" height="25" src="../../style/prj/images/fax.png">
									&nbsp;<span id="fax">传真:0592-5061718</span>
								   </div>
								    <div class="email">
								     <img width="24" height="25" src="../../style/prj/images/email.png">
									&nbsp;<span id="email">邮箱:info@waterrower.com.cn</span>
								   </div>
							 </div>
							 <div id="bottom">
							  <img width="24" height="25" src="../../style/prj/images/address.png">
									&nbsp;<span id="corpAddr">地址:厦门市塔埔东路166号8层（观音山国际商务运营中心11号楼8层）</span>
							 </div>
					 </div>
				</div>
          		 <!--联系我们结束-->
				 <div class="footerInfo">
				    <div class="footerInfoContainer">
					  <div class="footerInfoLeft"><img style="width:269px;height:32px" src="../../style/prj/images/LOGO-269x32.png"/>
					  </div>
					  <div class="footerInfoRight">
					      <div ><a href="wlCmSecrecyRules.html">保密规则</a>/ <a href="wlCmUseOfTerms.html">使用条款</a> / <a href="wlCmMap.html">网站地图</a> /<a href="wlCmcontactUs.html"> 关于我们</a> /<a href="wlCmSafetyPrecautions.html"> 安全预防措施</a></div>
						  <div >闽ICP备15007220号-2 | Copyright © 2014-2016 WaterRower.com.cn 版权所有 | 技术支持：<a href="http://www.xmguitian.com/" target="_Blank">硅田系统</a></div>
					  
					  </div>
					 </div>
				 </div>
</div>


  <script>
		$(function(){
				init();
			    getAddrList();
			    initGoodsList();
				//initTotal();
		});
       function init(){
                  $("#online_qq_layer").attr("show","1");
                   //$('input, textarea').placeholder();
					$("#carHeadList li").eq(0).addClass("firstItem");
					
					$(".carBodyList li").each(function(){
							$(this).children(".item").eq(0).addClass("firstItem");
					});
     }  
       var isHasAddress="0";//1含有，0没有
       function getAddrList(){
   		
    	  	joy.getJSON("../../wl/es/wlEsMyDeliveryAddrAction.web?action=getMyDeliveryAddrList",{},function(resultObject){
    	  		     var txt="";
    		  		 if(resultObject!=null){
    		  			 $("#generateOrdersList").empty();
    		  			    if(resultObject.length===0){
    		  			    	$("#noAddress").css("display","block");
    		  			    	isHasAddress="0";
    		  			    }else{
    		  			    	isHasAddress="1";
    		  			  	  $("#noAddress").css("display","none");
    		  			    }
    		  			 
    		  			 for(var i=0;i<resultObject.length;i++){
    			  		       ob=resultObject[i];
    			  		     if(i===0){
    			  		    	 txt+='<li  class="active">';
    						   txt+='<span class="marker-tip"  >寄送至</span>';
    						   txt+=' <div class="address">';
    						   txt+='<input type="radio"  id="'+ob.deliveryAddrId+'" value="'+ob.deliveryAddrId+'" name="address" checked="checked" onclick="chooseAddress($(this))" >';
    						   txt+='<label for="'+ob.deliveryAddrId+'">'+ob.province+' '+ob.city+' '+ob.area+' '+ob.addr+' ('+ob.receiver+' 收)<em>'+ob.mobile+'</em> </label>';
    			  		     }else{
    			  		    	  txt+='<li>';
    			  		    	  txt+='<span class="marker-tip"  style="display:none;" >寄送至</span>';
    			  		    	 txt+=' <div class="address">';					
    							txt+='<input type="radio"  id="'+ob.deliveryAddrId+'" value="'+ob.deliveryAddrId+'" name="address"  onclick="chooseAddress($(this))" >';
    							txt+='<label for="'+ob.deliveryAddrId+'">'+ob.province+'  '+ob.city+' '+ob.area+' '+ob.addr+' ('+ob.receiver+' 收)<em>'+ob.mobile+'</em> </label>';
    			  		     }
    						
    			  		    txt+='</div>';
    						txt+='</li>';
    			  		   }
    		  			 $("#generateOrdersList").html(txt);
    		  		 }
    			});
    		  
    	  }
       var source="";
       function initGoodsList(){
          
            source=getParam("source");
           if(source==="instantlyBuy"){//立即购买
        	   var sellId=getParam("sellId");
        	   var arraylist = new Array();
        	   arraylist[0]=sellId;
        	   joy.getJSON("../../wl/cm/wlCmSellAction.web?action=findSellsPages",{pageSize:100,currPage:1,sellStateEk:"HAS_SHELVE",isThumFlag:"1",sellIds:arraylist},function(resultObject){
        		   joy.getJSON("../../wl/es/wlEsMyShoppingCartAction.web?action=setOrGetOrderInfo",{isSet:"get"},function(result){//该界面修改了数量，点击下一步，再后退获得修改后的数量
        			    var num="1";
        			   if(result!=null){
        				   numsList=result.numsList;
        				   num=numsList[0];
        			   }
        			   resultObject.items[0].num=num;
	        		   resultObject.items[0].amt=resultObject.items[0].price*num;
	        		   resultObject.items[0].shoppingCartId="";
	        		   createGoodsList(resultObject);
        		   });   
        	   });   
           } else if(source==="myCar"){
        	   joy.getJSON("../../wl/es/wlEsMyShoppingCartAction.web?action=setOrGetShopSellId",{isSet:"get"},function(resultObject){
            	   joy.getJSON("../../wl/es/wlEsMyShoppingCartAction.web?action=findMyShoppingCartPage",{pageSize:100,currPage:1,isThumFlag:"1",sellIds:resultObject},function(resultObject){
            		   createGoodsList(resultObject);
            	   });  
     		  });
     		 
           }	   
       }
       // 创建产品列表
       function createGoodsList(resultObject){
    	   var txt="";
		    	if(resultObject!=null){
   		    		$(".carBodyList").empty();
   		    		for(var i=0;i<resultObject.items.length;i++){
   		    			ob=resultObject.items[i];
       		        txt+='<li value="'+ob.sellId+'">';	      		       
   		    		   txt+='<div class="item">';					
   		    		   txt+='<div  class="carImg">';
   		    		   txt+='<img src="../../wl/cm/wlCmDocumentAction.web?action=downloadFile&id='+ob.path+'" />';
   		    		   txt+='</div>';
   		    		   txt+=' <div class="carProductName">';
   		    		   txt+='<div class="carProductNameContent">';
   		    			txt+=ob.productName;
   		    			txt+='</div>';		
   		    			txt+='</div>';	 
   		    			txt+='</div>';
   					    txt+='<div class="item">';
   						 txt+=' <div class="verticalCenter">';
   						txt+=ob.price;
   							txt+='</div>';
   							txt+=' </div>';
   							txt+='<div class="item">';
   							txt+='<span class="carProductNumValue">';
   							txt+=' <div class="carReduce" onclick="reduceNum($(this))" >-</div>';
   							txt+='  <input type="text" maxlength="6" class="carNumber"  value="'+ob.num+'" />';  
   							txt+='<div class="carAdd" onclick="addNum($(this))">+</div>';	  
   							txt+=' </span>';
   							if(ob.inventoryState=="1"){
   	   							txt+=' <span class="sellWarning">暂无现货</span>';	
   							}else if(ob.inventoryState=="2"){
   	   							txt+=' <span class="sellWarning">库存紧张</span>';	
   							}
   							
   							 txt+='</div>';
   							 txt+=' <div  class="item"> <div class="verticalCenter">'+ob.amt+'</div></div>';
   							txt+='<div class="item operation">';
   							txt+='<div class="verticalCenter">';
   						  txt+='<span style="cursor:pointer" onclick="delGoods($(this),\''+ob.shoppingCartId+'\')">删除</span>';
   						txt+='</div>';
   						txt+='</div>';
   						txt+='</li>';
   		    		}	
   		    		$(".carBodyList").append(txt);
                      $("#carHeadList li").eq(0).addClass("firstItem");
   					$(".carBodyList li").each(function(){
   							$(this).children(".item").eq(0).addClass("firstItem");
   					});
   					initTotal();
   					triggerChangePrice();
		    	}			
   		   
   	     	   
    	   
       }
       // //初始化订单合计和应付总额赋值
          function initTotal(){
                    
              $(".carNumber").keyup(function(){    
			         var temp=$(this).val();
                     if(temp.match(/[^0-9]+/gi)||temp=='0'||temp==''){
						   //  numValue=numValue+"";
						 //numValue=$.trim(numValue.replace(/[^0-9]+/gi,''));
						  $(this).val("1");
					 }
              // $(this).val($(this).val().replace(/[^0-9.]+/gi,''));  
                }).bind("paste",function(){  //CTR+V事件处理    
						var temp=$(this).val();
                     if(temp.match(/[^0-9]+/gi)||temp=='0'||temp==''){
						       //  numValue=numValue+"";
							//  numValue=$.trim(numValue.replace(/[^0-9]+/gi,''));
							  //$(this).val(numValue);
							  $(this).val("1");
						 }               
					 }).css("ime-mode", "disabled"); //CSS设置输入法不可用 
				    traversingGoods();
			  };
          
		  //计算商品总价并为订单合计和应付总额赋值
           function traversingGoods(){
			   var totalPrice=0;
		      $(".carBodyList li").each(function(){
				   //var price=parseFloat( $(this).children(".item").eq(3).children().html());
				   var price=parseFloat( $(this).children(".item").eq(1).children().html());
				   var carNum=parseInt($(this).children(".item").eq(2).children(".carProductNumValue").children(".carNumber").val());
				   price=(10000*price)*carNum/10000;
				   if(price!=""){
				     $(this).children(".item").eq(3).children().html(price);
				   }
	               totalPrice=totalPrice+price;
			  });
		       $("#orderResultContainer span").html("¥"+totalPrice.toFixed(2));
			 $("#orderPrice span").html("¥"+totalPrice.toFixed(2));

		  }



//减少商品数量
       var numValue=0;
	function reduceNum(obj){
		 priceValue=parseInt(obj.next().val());
		 priceValue=--priceValue;
		 if(priceValue===1){
		 obj.attr("style","color:#A5A5A5");
		 if(!isNaN(priceValue)){
		  obj.next().val(priceValue);
		 }
		   numValue=priceValue+1;
		  changeTotalPrice(obj,priceValue+"");
		}
		 else if(priceValue>1){
			 obj.attr("style","color:#303030");
			   if(!isNaN(priceValue)){
			 obj.next().val(priceValue);
			   }
			 //  numValue=priceValue+1;
			  changeTotalPrice(obj,priceValue+"");

		  }
  }
  //增加商品数量
	function addNum(obj){
		priceValue=parseInt(obj.prev().val());
		priceValue=++priceValue;
		if(priceValue>1){
		obj.prev().prev().attr("style","color:#303030");
		}
		   if(!isNaN(priceValue)){
		  obj.prev().val(priceValue);
		   }
				 // numValue=priceValue-1;
		   changeTotalPrice(obj,priceValue+"");

}

//改变商品金额和合计
  function changeTotalPrice(obj,num){
        if(!num.match(/[^0-9]+/gi)||num!=='0'||num!==''){        
				 var price= parseFloat(obj.parents(".item").prev().children().html());
				  var thisTotalPrice=10000*price*num/10000;
					  if(!isNaN(thisTotalPrice)){
				        obj.parents(".item").next().children().html(thisTotalPrice);
					  }
				  /* totalFreightPrice=parseFloat($.trim($("#orderResultContainer span").html().replace(/[^0-9.]+/gi,'')));//扣除费用总价
					orderPrice=parseFloat($.trim($("#orderPrice span").html().replace(/[^0-9.]+/gi,'')));//扣除费用总价
					var temp=10000*price*(num-numValue)/10000;//获取增加或减少的价格
					  totalFreightPrice=(totalFreightPrice+temp).toFixed(2);
					  orderPrice=(orderPrice+temp).toFixed(2);
					  if(!isNaN(totalFreightPrice)){
					   $("#orderResultContainer span").html("¥"+totalFreightPrice);
						}
					 if(!isNaN(orderPrice)){
					 $("#orderPrice span").html("¥"+orderPrice);
					 }*/
					  traversingGoods();
	     }
	}
  
 //选择收货地址
     function chooseAddress(obj){
         obj.parents("li").siblings("li").removeClass("active");
	    obj.parents("li").addClass("active");
       $(".marker-tip").css("display","none");
       obj.parent().prev().css("display","block");
	 }
 
 function triggerChangePrice(){
	   $(".carNumber").mouseleave(function(){
		   var curValue=$(this).val();
			  $(this).val(curValue);
			  changeTotalPrice($(this),curValue);
		  
     });
	   $(".carBodyList li").hover(function(){
			 traversingGoods();
		 });
 }	   
  //当前获得焦点的文本框的数字
	/*	$(".carNumber").mouseenter(function(){
	                         
                      temp=$(this).val();
	                  if(!temp.match(/[^0-9]+/gi)||temp!=='0'||temp!==''){
							   numValue=$.trim($(this).val().replace(/[^0-9]+/gi,''));
				 }
		});*/
		
		

	   $("#message").mouseout(function(){
		    $(this).removeClass("messageActive");
	   });
	   $("#message").mouseenter(function(){
		    $(this).addClass("messageActive");
	  });
	   function delGoods(obj,shoppingCartId){			     
		     joy.showMessageDialog("确定要删除该商品吗?", "ok,cancel", function(e) {
					if (e.btnName == "ok") {
					     if(shoppingCartId===""){
							  obj.parent().parent().parent().remove();
							  traversingGoods();
					     }else{
					    	  joy.getJSON("../../wl/es/wlEsMyShoppingCartAction.web?action=delCarGoods",{shoppingCartId:shoppingCartId},function(resultObject){		     
								  obj.parent().parent().parent().remove();
								  traversingGoods();
							 });
					     }					     
					}
				});			
		  }
	  $("#nextStep").click(function(){
		  
		  var deliveryAddrId=$("input[type='radio']:checked").val();
		  var buyMsg=$("#message").val();
		   len=getByteLen(buyMsg);
		   if(len>255){			   
			   joy.showMessage("给卖家留言长度须小于255字节,已输入"+len, "warning");
			   return;
		   }
		  var sellIds=new Array();
		  var nums=new Array();
		  var goodsCount=-1;
		  $(".carBodyList li").each(function(index){
			  var sellId=$(this).attr("value");
			   var carNum=$(this).children(".item").eq(2).children(".carProductNumValue").children(".carNumber").val();
			   sellIds[index]=sellId;
			   nums[index]=carNum;
			   goodsCount=index;
		  });
		  if(goodsCount>=0&&deliveryAddrId!==""&&isHasAddress==="1"){			 		 
			  joy.postJSON("../../wl/es/wlEsMyShoppingCartAction.web?action=setOrGetOrderInfo",{deliveryAddrId:deliveryAddrId,buyMsg:buyMsg,sellIds:sellIds,nums:nums,source:source,isSet:"set"},function(resultObject){		     
				  window.location="wlEsCreateOrder.html";
			 });
		  }
		  if(goodsCount<0){
			  joy.showMessage("您当前没有商品，请先添加!", "warning");
		  }
		  
		  if(deliveryAddrId==""){
			  joy.showMessage("请先选择一个收货地址!", "warning");
		  }
		  if(isHasAddress==="0"){
			  joy.showMessage("请先添加一个收货地址!", "warning");
		  }
		  
	  });
	  function getByteLen(val) {    //传入一个字符串
          var len = 0;
          for (var i = 0; i < val.length; i++) {
              if (val[i].match(/[^\x00-\xff]/ig) != null) //全角 
                  len += 2; //如果是全角，占用两个字节
              else
                  len += 1; //半角占用一个字节
          }
          return len;

       }      
  </script>
  <script type="text/javascript" src="../../js/site/cnzz.js"></script>
 </body>
</html>
